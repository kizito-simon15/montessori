{# ================== expenditureinvoice_list.html ================== #}
{% extends "base.html" %}
{% load humanize %}
{% block content %}
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
:root{
  --primary:#1e3a8a; --secondary:#d97706; --bg:#f1f5f9;
  --danger:#dc2626;  --success:#16a34a; --radius:25px;
}
body{background:var(--bg);font-family:'Inter',sans-serif;margin:0;}
.card{background:#fff;border-radius:0 0 15px 15px;box-shadow:0 3px 8px rgba(0,0,0,.05);
      overflow:hidden;opacity:0;transform:translateY(20px);
      transition:opacity .5s ease,transform .5s ease;}
.card-header{background:#fff;padding:.5rem 1rem;display:flex;justify-content:space-between;
             align-items:center;border-bottom:1px solid #e5e7eb;}
.card-header h2{margin:0;font-size:clamp(1.3rem,4vw,1.6rem);font-weight:700;color:var(--primary);}
.card-body{padding:.5rem 1rem;display:flex;flex-direction:column;gap:.5rem;}
.table{width:100%;border-collapse:collapse;font-size:.9rem;}
.table thead{background:var(--primary);color:#fff;}
.table th,.table td{padding:.4rem .6rem;text-align:left;border-bottom:1px solid #e5e7eb;}
.table tbody tr:nth-child(odd){background:#f8fafc;}
.table tbody tr:hover{background:#e2e8f0;}
.text-end{text-align:right;}
.btn{border:none;border-radius:var(--radius);padding:.4rem .9rem;font-weight:600;
     font-size:.8rem;cursor:pointer;transition:background .15s,transform .15s;}
.btn-primary{background:var(--primary);color:#fff;}
.btn-primary:hover{background:var(--secondary);transform:translateY(-2px);}
.btn-danger{background:var(--danger);color:#fff;}
.btn-danger:hover{opacity:.9;transform:translateY(-2px);}
@media(max-width:640px){.table th,.table td{padding:.3rem;font-size:.8rem;}}
</style>

<script>
document.addEventListener('DOMContentLoaded',()=>{const c=document.querySelector('.card');
  if(c){setTimeout(()=>{c.style.opacity='1';c.style.transform='translateY(0)';},80);}
});
</script>

<div class="card">
  <div class="card-header">
    <h2>üí∞ Expenditure Invoices</h2>
    <a href="{% url 'expenditureinvoice_create' %}" class="btn btn-primary">‚ûï New</a>
  </div>

  <div class="card-body">
    <table class="table">
      <thead>
        <tr>
          <th>#</th><th>Date</th><th>Depositor</th><th>Session</th>
          <th class="text-end">Initial Balance</th>
          <th class="text-end">Spent</th>
          <th class="text-end">Remaining</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for inv in rows %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ inv.date }}</td>
            <td>{{ inv.depositor_name }}</td>
            <td>{{ inv.session|default:"‚Äî" }}</td>
            <td class="text-end">{{ inv.initial_balance|floatformat:2|intcomma }}</td>
            <td class="text-end">{{ inv.spent|floatformat:2|intcomma }}</td>
            <td class="text-end">
              {% if inv.remaining < 0 %}
                <span style="color:var(--danger);">{{ inv.remaining|floatformat:2|intcomma }}</span>
              {% else %}
                <span style="color:var(--success);">{{ inv.remaining|floatformat:2|intcomma }}</span>
              {% endif %}
            </td>
            <td>
              <a href="{% url 'expenditureinvoice_detail' inv.pk %}"   class="btn btn-primary">üîç</a>
              <a href="{% url 'expenditureinvoice_update' inv.pk %}"   class="btn btn-primary">‚úèÔ∏è</a>
              <a href="{% url 'expenditureinvoice_delete' inv.pk %}"   class="btn btn-danger">üóëÔ∏è</a>
            </td>
          </tr>
        {% empty %}
          <tr><td colspan="8">No invoices recorded yet.</td></tr>
        {% endfor %}
      </tbody>
      <tfoot>
        <tr style="font-weight:700;">
          <td colspan="4" class="text-end">Totals</td>
          <td class="text-end">{{ total_initial_balance|floatformat:2|intcomma }}</td>
          <td class="text-end">{{ total_spent|floatformat:2|intcomma }}</td>
          <td class="text-end">{{ remaining|floatformat:2|intcomma }}</td>
          <td></td>
        </tr>
      </tfoot>
    </table>
  </div>
</div>
{% endblock %}
