{# ================== expenditure_report.html ================== #}
{% extends "base.html" %}
{% load humanize %}
{% block content %}
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
:root{
  --primary:#1e3a8a;--secondary:#d97706;--bg:#f1f5f9;--danger:#dc2626;--success:#16a34a;--radius:25px;
}
body{background:var(--bg);font-family:'Inter',sans-serif;margin:0;}
.card{background:#fff;border-radius:0 0 20px 20px;box-shadow:0 6px 12px rgba(0,0,0,.06);overflow:hidden;opacity:0;transform:translateY(30px);transition:.6s;}
.card-header{background:linear-gradient(135deg,var(--primary) 0%,var(--secondary) 100%);padding:.8rem 1rem;color:#fff;display:flex;justify-content:space-between;align-items:center;}
.card-header h2{margin:0;font-size:clamp(1.4rem,4vw,1.8rem);font-weight:700;display:flex;gap:.5rem;align-items:center;}
.card-body{padding:1rem;display:flex;flex-direction:column;gap:1rem;}
.summary-bar{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:.75rem;}
.summary-item{background:#f8fafc;border-radius:var(--radius);padding:.6rem .9rem;text-align:center;box-shadow:0 2px 6px rgba(0,0,0,.05);}
.summary-item h3{margin:0;font-size:1.1rem;color:var(--primary);} 
.summary-item p{margin:.1rem 0 0;font-size:.85rem;color:#374151;}
.table{width:100%;border-collapse:collapse;font-size:.9rem;}
.table thead{background:var(--primary);color:#fff;}
.table th,.table td{padding:.45rem .7rem;text-align:left;border-bottom:1px solid #e5e7eb;}
.table tbody tr:nth-child(even){background:#f8fafc;}
.table tbody tr:hover{background:#e2e8f0;}
.text-end{text-align:right;}
.btn{border:none;border-radius:var(--radius);padding:.45rem .95rem;font-weight:600;font-size:.8rem;cursor:pointer;transition:background .15s,transform .15s;}
.btn-secondary{background:#6b7280;color:#fff;}
.btn-secondary:hover{background:#4b5563;transform:translateY(-2px);} 
@media(max-width:640px){.summary-bar{grid-template-columns:1fr;}.table th,.table td{padding:.35rem;}}
</style>
<script>
document.addEventListener('DOMContentLoaded',()=>{
  const card=document.querySelector('.card');if(card){setTimeout(()=>{card.style.opacity='1';card.style.transform='translateY(0)';},80);} 
});
</script>
<div class="card">
  <div class="card-header">
    <h2>üìä {{ period|title }} Expenditure Report</h2>
    <a href="{% url 'expenditure_list' %}" class="btn btn-secondary">‚Üê Back</a>
  </div>

  <div class="card-body">
    <!-- Summary Tiles -->
    <div class="summary-bar">
      <div class="summary-item">
        <h3>{{ rows|length }}</h3><p>Total Records</p>
      </div>
      <div class="summary-item" style="background:#d1fae5;">
        <h3>{{ total|floatformat:2|intcomma }}</h3><p>Total Amount (TZS)</p>
      </div>
      {% if period == 'daily' %}
      <div class="summary-item" style="background:#fef9c3;">
        <h3>{{ today }}</h3><p>Date</p>
      </div>
      {% endif %}
    </div>

    <!-- Data table -->
    <table class="table">
      <thead><tr><th>#</th><th>Date</th><th>Budget</th><th>Item</th><th class="text-end">Amount</th></tr></thead>
      <tbody>
        {% for obj in rows %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td>{{ obj.date }}</td>
          <td>{{ obj.budget_line.name }}</td>
          <td>{{ obj.item_name }}</td>
          <td class="text-end">{{ obj.amount|floatformat:2|intcomma }}</td>
        </tr>
        {% empty %}<tr><td colspan="5">No data for this period.</td></tr>{% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
